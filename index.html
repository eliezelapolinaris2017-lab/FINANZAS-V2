<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Finance Manager</title>
  <link rel="stylesheet" href="styles.css"/>
</head>
<body>
  <aside id="sidebar" class="sidebar">
    <div class="brand">
      <img id="brandLogo" alt="Logo">
      <div class="brand-info">
        <span id="brandName">Mi Negocio</span>
        <small>Finance Manager</small>
      </div>
    </div>
    <nav class="menu">
      <button class="nav-btn active" data-target="home">üè† Inicio</button>
      <button class="nav-btn" data-target="expenses">üí≥ Gastos Diarios</button>
      <button class="nav-btn" data-target="reports">üìä Reportes</button>
      <button class="nav-btn" data-target="exports">üßæ Exportaciones en PDF</button>
      <button class="nav-btn" data-target="incomes">üíµ Entrada de Dinero</button>
      <button class="nav-btn" data-target="payments">üì§ Pagos</button>
      <button class="nav-btn" data-target="ordinary">üîÅ Gastos Ordinarios</button>
      <button class="nav-btn" data-target="settings">‚öôÔ∏è Configuraci√≥n</button>
      <button class="nav-btn" data-target="login">üîí Login</button>
      <button class="nav-btn" data-target="budgets">üìö Control de Gastos</button>
      <button class="nav-btn" data-target="personal">üßç Gastos Personales</button>
    </nav>
  </aside>

  <main class="main">
    <header class="topbar">
      <button id="menuToggle" class="menu-toggle">‚ò∞</button>
      <h1 id="viewTitle">Inicio</h1>
      <div class="cloud">
        <span id="cloudStatus">No conectado</span>
        <button id="btnSignIn" class="btn">Iniciar con Google</button>
        <button id="btnSignOut" class="btn btn-outline">Cerrar sesi√≥n</button>
        <label class="auto"><input type="checkbox" id="cloudAuto"> Autosync</label>
      </div>
    </header>

    <!-- HOME -->
    <section id="home" class="view visible" data-title="Inicio">
      <div class="grid kpis">
        <div class="card"><div class="card-title">Ingresos del mes</div><div id="kpiIncomesMonth" class="kpi">‚Äî</div></div>
        <div class="card"><div class="card-title">Gastos del mes</div><div id="kpiExpensesMonth" class="kpi">‚Äî</div></div>
        <div class="card"><div class="card-title">Balance del mes</div><div id="kpiBalanceMonth" class="kpi">‚Äî</div></div>
      </div>
      <div class="card">
        <div class="card-title">Ingresos vs Gastos (12 meses)</div>
        <canvas id="chart12" height="180"></canvas>
      </div>
    </section>

    <!-- GASTOS DIARIOS (form ARRIBA) -->
    <section id="expenses" class="view" data-title="Gastos Diarios">
      <div class="card">
        <div class="card-title">Nuevo gasto</div>
        <form id="expenseForm" class="form">
          <div class="grid2">
            <label>Fecha <input type="date" id="expDate" required></label>
            <label>Categor√≠a
              <select id="expCategory" required></select>
            </label>
            <label>Descripci√≥n <input type="text" id="expDesc" placeholder="Detalle"></label>
            <label>M√©todo
              <select id="expMethod"></select>
            </label>
            <label>Monto <input type="number" step="0.01" id="expAmount" required></label>
            <label>Nota <input type="text" id="expNote" placeholder="Opcional"></label>
          </div>
          <div class="row end">
            <button type="button" id="addExpense" class="btn btn-outline">Hoy</button>
            <button type="submit" class="btn">Guardar</button>
          </div>
        </form>
      </div>

      <div class="card">
        <div class="row g">
          <label>Desde: <input type="date" id="fExpFrom"></label>
          <label>Hasta: <input type="date" id="fExpTo"></label>
          <button id="fExpApply" class="btn">Filtrar</button>
        </div>
        <div class="table-wrap">
          <table id="expensesTable" class="table">
            <thead>
              <tr><th>Fecha</th><th>Categor√≠a</th><th>Descripci√≥n</th><th>M√©todo</th><th>Monto</th><th>Nota</th><th></th></tr>
            </thead>
            <tbody></tbody>
            <tfoot><tr><td colspan="4">Total</td><td id="expensesTotal">‚Äî</td><td colspan="2"></td></tr></tfoot>
          </table>
        </div>
        <div id="expCategoryTotals" class="pills"></div>
      </div>
    </section>

    <!-- REPORTES -->
    <section id="reports" class="view" data-title="Reportes">
      <div class="grid kpis">
        <div class="card"><div class="card-title">Hoy (Ingresos/Gastos)</div><div id="rToday" class="kpi">‚Äî</div></div>
        <div class="card"><div class="card-title">Semana</div><div id="rWeek" class="kpi">‚Äî</div></div>
        <div class="card"><div class="card-title">Mes</div><div id="rMonth" class="kpi">‚Äî</div></div>
        <div class="card"><div class="card-title">A√±o</div><div id="rYear" class="kpi">‚Äî</div></div>
      </div>
      <div class="card"><div class="card-title">Mini-Barras</div><div id="barsIG" class="bars"></div></div>
    </section>

    <!-- EXPORTACIONES -->
    <section id="exports" class="view" data-title="Exportaciones en PDF">
      <div class="card">
        <div class="card-title">Generar PDF (blanco y negro, plano)</div>
        <div class="row g">
          <button class="btn" id="pdf-current">Exportar vista actual</button>
          <button class="btn btn-outline" data-pdf-view="expenses">PDF: Gastos</button>
          <button class="btn btn-outline" data-pdf-view="incomes">PDF: Ingresos</button>
          <button class="btn btn-outline" data-pdf-view="payments">PDF: Pagos</button>
          <button class="btn btn-outline" data-pdf-view="ordinary">PDF: Ordinarios</button>
          <button class="btn btn-outline" data-pdf-view="personal">PDF: Personales</button>
          <button class="btn btn-outline" data-pdf-view="reports">PDF: Reportes</button>
        </div>
      </div>
    </section>

    <!-- ENTRADA DE DINERO (form ARRIBA) -->
    <section id="incomes" class="view" data-title="Entrada de Dinero Diario">
      <div class="card">
        <div class="card-title">Nuevo ingreso</div>
        <form id="incomeForm" class="form">
          <div class="grid2">
            <label>Fecha <input type="date" id="incDate" required></label>
            <label>Cliente <input type="text" id="incClient"></label>
            <label>M√©todo <select id="incMethod" required></select></label>
            <label>Monto <input type="number" step="0.01" id="incAmount" required></label>
          </div>
          <div class="row end">
            <button type="button" id="addIncome" class="btn btn-outline">Hoy</button>
            <button type="submit" class="btn">Guardar</button>
          </div>
        </form>
      </div>

      <div class="card">
        <div class="row g">
          <label>Desde: <input type="date" id="fIncFrom"></label>
          <label>Hasta: <input type="date" id="fIncTo"></label>
          <button id="fIncApply" class="btn">Filtrar</button>
        </div>
        <div class="table-wrap">
          <table id="incomesTable" class="table">
            <thead><tr><th>Fecha</th><th>Cliente</th><th>M√©todo</th><th>Monto</th><th></th></tr></thead>
            <tbody></tbody>
            <tfoot><tr><td colspan="3">Total</td><td id="incomesTotal">‚Äî</td><td></td></tr></tfoot>
          </table>
        </div>
      </div>
    </section>

    <!-- PAGOS (form ARRIBA) -->
    <section id="payments" class="view" data-title="Pagos">
      <div class="card">
        <div class="card-title">Nuevo pago</div>
        <form id="paymentForm" class="form">
          <div class="grid2">
            <label>Fecha <input type="date" id="payDate" required></label>
            <label>A (Proveedor/Servicio) <input type="text" id="payTo" required></label>
            <label>Categor√≠a <input type="text" id="payCategory"></label>
            <label>Monto <input type="number" step="0.01" id="payAmount" required></label>
            <label>Estado
              <select id="payStatus">
                <option>Pendiente</option>
                <option>Pagado</option>
              </select>
            </label>
          </div>
          <div class="row end">
            <button id="addPayment" type="button" class="btn btn-outline">Hoy</button>
            <button type="submit" class="btn">Guardar</button>
          </div>
        </form>
      </div>

      <div class="card">
        <div class="table-wrap">
          <table id="paymentsTable" class="table">
            <thead><tr><th>Fecha</th><th>A</th><th>Categor√≠a</th><th>Monto</th><th>Estado</th><th></th></tr></thead>
            <tbody></tbody>
          </table>
        </div>
        <div id="payTotals" class="pills"></div>
      </div>
    </section>

    <!-- GASTOS ORDINARIOS (form ARRIBA) -->
    <section id="ordinary" class="view" data-title="Gastos Ordinarios">
      <div class="card">
        <div class="card-title">Nuevo gasto recurrente</div>
        <form id="ordinaryForm" class="form">
          <div class="grid2">
            <label>Nombre <input type="text" id="ordName" required></label>
            <label>Monto <input type="number" step="0.01" id="ordAmount" required></label>
            <label>Frecuencia
              <select id="ordFreq">
                <option value="semanal">Semanal</option>
                <option value="mensual">Mensual</option>
                <option value="anual">Anual</option>
              </select>
            </label>
            <label>Pr√≥xima fecha <input type="date" id="ordNext" required></label>
          </div>
          <div class="row end">
            <button id="addOrd" type="button" class="btn btn-outline">Hoy</button>
            <button type="submit" class="btn">Guardar</button>
          </div>
        </form>
      </div>

      <div class="card">
        <div class="table-wrap">
          <table id="ordinaryTable" class="table">
            <thead><tr><th>Nombre</th><th>Monto</th><th>Frecuencia</th><th>Pr√≥xima</th><th></th></tr></thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </section>

    <!-- CONTROL DE GASTOS -->
    <section id="budgets" class="view" data-title="Control de Gastos">
      <div class="card">
        <div class="card-title">Presupuestos por categor√≠a</div>
        <div id="budgetBars"></div>
      </div>
      <div class="card">
        <div class="card-title">Nuevo presupuesto</div>
        <form id="budgetForm" class="form">
          <div class="grid2">
            <label>Categor√≠a <input type="text" id="budCategory"></label>
            <label>L√≠mite <input type="number" step="0.01" id="budLimit"></label>
          </div>
          <div class="row end">
            <button id="addBudget" type="button" class="btn btn-outline">Agregar</button>
            <button type="submit" class="btn">Guardar</button>
          </div>
        </form>
      </div>
    </section>

    <!-- GASTOS PERSONALES (form ARRIBA) -->
    <section id="personal" class="view" data-title="Gastos Personales">
      <div class="card">
        <div class="card-title">Nuevo gasto personal</div>
        <form id="personalForm" class="form">
          <div class="grid2">
            <label>Fecha <input type="date" id="perDate" required></label>
            <label>Categor√≠a <input type="text" id="perCategory"></label>
            <label>Descripci√≥n <input type="text" id="perDesc"></label>
            <label>Monto <input type="number" step="0.01" id="perAmount" required></label>
          </div>
          <div class="row end">
            <button id="addPersonal" type="button" class="btn btn-outline">Hoy</button>
            <button type="submit" class="btn">Guardar</button>
          </div>
        </form>
      </div>

      <div class="card">
        <div class="table-wrap">
          <table id="personalTable" class="table">
            <thead><tr><th>Fecha</th><th>Categor√≠a</th><th>Descripci√≥n</th><th>Monto</th><th></th></tr></thead>
            <tbody></tbody>
            <tfoot><tr><td colspan="3">Total</td><td id="personalTotal">‚Äî</td><td></td></tr></tfoot>
          </table>
        </div>
      </div>
    </section>

    <!-- CONFIGURACI√ìN -->
    <section id="settings" class="view" data-title="Configuraci√≥n">
      <div class="card">
        <div class="grid2">
          <label>Nombre del negocio <input type="text" id="setName" placeholder="Mi Negocio"></label>
          <label>Moneda (ISO) <input type="text" id="setCurrency" placeholder="USD"></label>
          <label>Primario <input type="color" id="colorPrimary" value="#0b0b0e"></label>
          <label>Acento <input type="color" id="colorAccent" value="#C7A24B"></label>
          <label>Texto <input type="color" id="colorText" value="#ffffff"></label>
          <label>Logo <input type="file" id="setLogo" accept="image/*"></label>
        </div>
        <div class="row g">
          <img id="logoPreview" class="logo-preview" alt="Logo">
          <button id="delLogo" class="btn btn-outline">Eliminar logo</button>
          <button id="saveSettings" class="btn">Guardar</button>
        </div>
      </div>
      <div class="card">
        <div class="card-title">PIN</div>
        <div class="grid2">
          <label>PIN actual <input type="password" id="pinOld"></label>
          <label>Nuevo PIN <input type="password" id="pinNew"></label>
          <label>Repetir PIN <input type="password" id="pinNew2"></label>
        </div>
        <button id="changePIN" class="btn">Cambiar PIN</button>
      </div>
      <div class="card">
        <div class="card-title">Datos</div>
        <div class="row g">
          <button id="exportJSON" class="btn">Exportar JSON</button>
          <label class="btn btn-outline">
            Importar JSON <input type="file" id="importJSON" accept="application/json" hidden>
          </label>
          <button id="resetAll" class="btn btn-outline">Restablecer todo</button>
          <button id="cloudPull" class="btn btn-outline">Cargar de la nube</button>
          <button id="cloudPush" class="btn">Guardar en la nube</button>
        </div>
      </div>
    </section>

    <!-- LOGIN -->
    <section id="login" class="view" data-title="Login">
      <div class="card">
        <h2 id="loginTitle">Ingresar PIN</h2>
        <p id="loginHint">Introduce tu PIN para acceder.</p>
        <div class="grid2">
          <label>PIN <input type="password" id="loginPIN"></label>
          <label id="pin2wrap">Repetir PIN <input type="password" id="loginPIN2" style="display:none"></label>
        </div>
        <div class="row g">
          <button id="loginBtn" class="btn">Entrar</button>
          <span id="loginAttempts"></span>
        </div>
      </div>
    </section>
  </main>

  <div id="toastContainer"></div>

  <!-- jsPDF + AutoTable (PDF reales) -->
  <script defer src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/jspdf-autotable@3.8.1/dist/jspdf.plugin.autotable.min.js"></script>

  <!-- App -->
  <script type="module" src="app.js?v=10"></script>
</body>
</html>
